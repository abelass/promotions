#SET{saisies, #ENV{type_promotion}|promotions_definition_saisies{#ENV}}

#GENERER_SAISIES{#GET{saisies}}

<script type="text/javascript">
	$(function() {
		$("#champ_plugins_applicables").change(function() {
			$("option:selected", $(this)).each(function() {

				// Obtenir les valeurs des champs généraux
				var data = $('.formulaire_editer_promotion form .fieldset_general').find(
								'input, select, radio, textarea, checkbox');
				var values = {};
				jQuery.each( data, function( i, field ) {
					//console.log($(field).val());
					var f = $(field).serialize();
					console.log(f)
						values[$(field).name()] = $(field).val();
				});

				// Recharger les champs
				ajaxReload('promotion_champs_generaux', {
					args : values
					,
					callback : function() {
						// Adapter si changé après reload.
						values.type_promotion = $('#champ_type_promotion').val();
						ajaxReload('promotion_champs_specifiques', {
							args : values
						});
					}
				});
			});
		});

		$("#champ_type_promotion").change(function() {
			$("option:selected", $(this)).each(function() {
				var type_promotion = $(this).attr('value');
				ajaxReload('promotion_champs_specifiques', {
					args : {
						type_promotion : type_promotion,
					}
				});
			});
		});
	});

</script>

